This is the solution given in the master branch
